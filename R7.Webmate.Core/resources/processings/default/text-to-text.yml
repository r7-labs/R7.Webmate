---
commands:
# normalize endlines
- !!replace
  pattern: "\r\n"
  replacement: "\n"
# remove excess empty lines (more than 2 is too much)
- !!regex-replace
  pattern: "\n{3,}"
  replacement: "\n\n"
- !!replace
  pattern: "\r"
  replacement: "\n"
# replace tabs with spaces
- !!replace
  pattern: "\t"
  replacement: " "
# remove spaces before closing punctuation
- !!regex-replace
  pattern: " ([\\.,;:\\)\\}\\]\\?!])"
  replacement: "$1"
- !!regex-replace
  pattern: " +"
  replacement: " "
# remove extra punctuation before closing bracket
- !!replace
  pattern: ".)."
  replacement: ")."
- !!replace
  pattern: "!)."
  replacement: ")!"
- !!replace
  pattern: "?)."
  replacement: ")?"
# replace figure quotes (for ASCII output)
- !!regex-replace
  pattern: "[«»]"
  replacement: '"'
# remove hyphens
- !!replace
  pattern: "¬"
  replacement: ""
# TODO: replace double hyphens with en dash (for Unicode output)
#- !!replace
#  pattern: " -- "
#  replacement: "\\u2013"
# fix some common typos in russian
- !!regex-replace
  pattern: "(\\d+)г\\."
  replacement: "$1 г."
- !!regex-replace
  pattern: "(\\d+)р\\."
  replacement: "$1 р."
- !!regex-replace
  pattern: "(\\d+)руб\\."
  replacement: "$1 руб."
- !!replace
  pattern: "г.г."
  replacement: "гг."
- !!replace
  pattern: "с\\х"
  replacement: "с.-х."
- !!replace
  pattern: "с/х"
  replacement: "с.-х."
- !!replace
  pattern: "с.х."
  replacement: "с.-х."
# TODO: Add i.e. => i. e., e.g. => e. g. for Unicode output
# remove duplicate spaces
- !!regex-replace
  pattern: " +"
  replacement: " "
# trim text
- !!trim {}
